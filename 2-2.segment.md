

### 사전 지식(pandas)



- 행 데이터를 열 데이터로 회전 시키는 것을 Pivot 이라고 함.
- 특정 컬럼의 값들을 컬럼으로, 또 다른 컬럼은 특정 컬럼의 값으로 종속시킬 수 있다.

- ![](./img/01.png)
- ![](./img/02.png)
- ![](./img/03.png)

- 위의 코드들을 보면 typecode 열들의 값이 column으로, volume 컬럼이 해당 컬럼에 맞는 value가 된 것을 확인 할 수 있다.



### rating_matrix

---

rating 데이터의 경우 user_id와 movie_id, 그리고 rating 값으로 이루어져 있다.

우리가 실행하려는 예측 방법은 **사용자 특성에 따라 집단으로 나누어서 예측하는 방법**이다.

그러므로 우리가 구한 rating 데이터(u.data) 에 사용자 특성 데이터(u.user)를 합칠 필요가 있으므로

평점 데이터의 full matrix를 구하려는 것이다.

(유저 데이터와 합치는 기준 컬럼은 user_id 이기 때문에 해당 column을 index로 지정해주는 것이다.)

여기서 **full matrix**란, 본래 사용자-영화-평점으로 이루어 져 있는 데이터를 feature engineering을 통해서

사용자와 영화를 각각 차원으로 mapping 한 array라고 볼 수 있다.

**유의 할 점** : 평가하지 않은 영화에 대해서는 NaN값을 가진다.



### score Function

---

파이썬도 JS처럼 함수로 일급 객체로 취급하는 듯 함.

이 코드에서 score Function 은 model 파라미터를 갖는데, 해당 파라미터는 함수를 값으로 받는다.

그래서 모델 함수를 넘겨받고, 유저와 영화의 테스트 데이터(x_test)를 입력하여 예측하고

평가 함수로 RMSE를 사용하여 넘겨준다.

예측 시 배열에 각각 모델 결과값을 담는다.

np.array로 data 값을 배열로 만드는 특성이 있다. 그러나 평가 함수(RMSE)에서 혹시 몰라 한번 더 배열로 만들어주긴 한다.

**즉, score함수는 주어진 x데이터에서 모델 결과와 y값을 비교하는 함수 이다.**



**실제 실행과정**

- 함수들 설계
- 모델 함수 실행  (best-seller 모델 함수는 내부에 평점 평균 값을 집어넣음)
- 정확도 계산 (주어진 모델의 값과 실제 값의 RMSE 값 도출)
- 여기서 예측하는데 사용한 모델은 평점 평균 모델임
- 결과적으로 RMSE값이 증가함. 자신의 테스트 값으로 test하지 않았으므로 오차율이 증가한 것임