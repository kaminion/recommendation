본 문서는 Collaborative Filtering 에 대한 설명을 서술한 문서이다.



### Collaborative Filtering

---

앞 장에서는 사용자를 집단별 (성별, 직업 등) 추천이 정확한 결과를 내지 못한 것을 보았다.

인구통계적 변수를 기준으로 나누는 것이 아닌, 취향을 기준으로 나눈다면 개선 할 수 있을 것이다.

**기본적인 아이디어**는 **어떤 아이템에 대해 비슷한 취향을 가진 사람들**은 **다른 아이템에 대해서도 비슷한 취향을 가졌을 것이라고 가정** 하는 추천 알고리즘이 **협업 필터링(Collaborative Filtering)**이다.



### 협업필터링의 원리

---

위의 기본적인 아이디어에서 착안한 알고리즘을 발전시켜 다음과 같의 정의한다.



- 기본적으로 취향이 비슷한 사람들의 집단이 존재한다고 가정
- 추천의 대상이 되는 사람(추천이 필요한 사람)이 있으면 이 사람과 취햐이 비슷한 사람들을 찾아냄 (neighborhood)
- 이 사람들이 공통적으로 좋아하는 제품/서비스를 추천 대상인 사람에게 추천하면 된다는 것이 알고리즘임



영화추천을 예로 들자면, 영화에 대한 사용자 평점이 있다는 테이블이 있다고 가정했을 때,

- **유저와 비슷한 취향을 가진 사용자들을 찾고**, 각 사용자 평가의 유사성(similarity)를 계산한다.

- 그 다음은 유사한 사용자들이 가장 좋게 평가한 영화를 찾는다. (평점 평균을 이용함)
- 따라서 평점 평균이 높은 영화를 추천 영화로 제시한다.



**사용자 간 유사도 지표**

1. [상관 계수](./3장_협업필터링.md)

   - 자세한 설명은 다른 문서에 기재하였으니 참고바람.

   - 여기서는 벡터 간 거리로 유사도를 평가하므로 피어슨 상관계수가 사용됨

   - 값 해석
     - 순서형의 척도이므로 각 구간별 차이가 동일한 격차를 나타내지 않는다.
       - 0.9 - 1.0 : 매우 높은 음/양 상관 관계
       - 0.7 - 0.9 : 높은 음/양 상관 관계
       - 0.5 - 0.7 : 보통의 음/양 상관 관계
       - 0.0 - 0.1 : 상관 관계가 거의 없음
       - 의학계같은 곳에서는 0.2도 매우 중요한 발견일 수 있음

2. 코사인 유사도

   - 상관계수는 이해하기 쉽지만 협업필터링에서 좋은 결과를 가져오진 않음

   - 협업 필터링에서 많이 사용하는 유사도 측정치로는 코사인 유사도가 있음

   - 각 아이템을 차원으로 보고, 사용자의 평가 값을 좌표값으로 봄으로써 각 사용자의 평가값을 벡터로, 두 사용자간의 벡터의 각도(코사인 값)을 구할 수 있다. **(배열로 생각하라, 1차원은 가로로, 2차원은 세로로 가니, 2차원인 평가데이터는 세로로 가는 데이터)**

   - 식은 아래와 같다.

   - $$
     simil(x,\ y) = \cos(\vec{x},\ \vec{y}) = \frac{\vec{x}\ \cdot\ \vec{y}}{\norm{\vec{x}}\times \norm{\vec{y}}} = \frac{\sum_{i \in I_{xy}}{r_{x, i}r_{y, i}}}{\sqrt{\sum_{i \in I_x}{r^2_{x, i}}}\sqrt{\sum_{i \in I_y }{r^2_{y, i}}}}
     $$

   - 참고로 여기서 L2 Distance를 사용하여 구한 값이라고 보면 된다.

3. 타니모토 계수

   - 데이터가 이진값(binary)을 가진다면, 상관계수나 코사인 유사도는 사용할 수 없다. 이 경우 널리 사용되는 유사도식은 타니모토 계수가 있다.

   - $$
     simil(x, y) = \frac{c}{a+b-c}
     $$

   - a: 사용자 x가 1의 값을 갖는(구입한 혹은 클릭한) 아이템의 수

   - b: 사용자 y가 1의 값을 갖는(구입한 혹은 클릭한) 아이템의 수

   - c: 사용자 x와 y가 공통적으로 1의 값을 갖는 아이템 수

   - 타니모토 계수 역시 최소 0(완전 불일치), 최대 1(완전 일치)의 값을 갖는다.

   - 간단하지만 이진데이터에 대해 협업필터링에서 좋은 성능을 보여준다.

   - 타니모토 계수의 변형으로 자카드 계수가 있다.





